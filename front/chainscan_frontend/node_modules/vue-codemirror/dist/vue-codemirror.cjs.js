/*!
* VueCodemirror v6.0.0
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon <https://github.com/surmon-china>
*/
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vue"),t=require("codemirror"),n=require("@codemirror/view"),r=require("@codemirror/state"),o=require("@codemirror/commands"),i=require("@codemirror/language"),u=Symbol("vue-codemirror-global-config");var a=function(e){var t=e.config,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["config"]),i=Array.isArray(t.extensions)?t.extensions:[t.extensions];return r.EditorState.create({doc:t.doc,selection:t.selection,extensions:i.concat([n.EditorView.updateListener.of((function(e){o.onUpdate(e),e.docChanged&&o.onChange(e.state.doc.toString(),e),e.focusChanged&&(e.view.hasFocus?o.onFocus(e):o.onBlur(e))}))])})},c=function(){var e=new r.Compartment;return{compartment:e,run:function(t,n){e.get(t.state)?t.dispatch({effects:e.reconfigure(n)}):t.dispatch({effects:r.StateEffect.appendConfig.of(e.of(n))})}}},s=function(){return c().run},f=function(e){var t=c(),n=t.compartment,r=t.run;return function(t,o){var i=n.get(t.state);r(t,(null!=o?o:i!==e)?e:[])}},d=function(e){return n.placeholder(e)},l=function(){return[n.EditorView.editable.of(!1),r.EditorState.readOnly.of(!0)]},m=function(){return n.keymap.of([o.indentWithTab])},p=function(e){return[r.EditorState.tabSize.of(e),i.indentUnit.of(" ".repeat(e))]},v=function(e){return n.EditorView.theme({"&":Object.assign({},e)})},b={autofocus:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},indentWithTab:{type:Boolean,default:void 0},tabSize:Number,placeholder:String,style:Object,root:Object,extensions:Array,selection:Object},g=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",extensions:[t.basicSetup]}),h=e.defineComponent({name:"VueCodemirror",props:Object.assign({modelValue:{type:String,required:!1,default:""}},b),emits:{"update:modelValue":function(e,t){return!0},change:function(e,t){return!0},update:function(e){return!0},focus:function(e){return!0},blur:function(e){return!0},ready:function(e){return!0}},setup:function(t,r){var o=e.ref(),i={view:null,state:null},c=Object.assign(Object.assign({},g),e.inject(u,{})),b=e.computed((function(){return Object.keys(t).reduce((function(e,n){var r,o;return Object.assign(Object.assign({},e),((r={})[n]=null!==(o=t[n])&&void 0!==o?o:c[n],r))}),{})}));return e.onMounted((function(){i.state=a({config:{doc:t.modelValue,selection:b.value.selection,extensions:c.extensions},onFocus:function(e){return r.emit("focus",e)},onBlur:function(e){return r.emit("blur",e)},onUpdate:function(e){return r.emit("update",e)},onChange:function(e,n){e!==t.modelValue&&(r.emit("update:modelValue",e,n),r.emit("change",e,n))}}),i.view=new n.EditorView({state:i.state,parent:o.value,root:b.value.root});var u=s();e.watch((function(){return t.extensions}),(function(e){return u(i.view,e||[])}),{immediate:!0});var g=f(l());e.watch((function(){return b.value.disabled}),(function(e){return g(i.view,e)}),{immediate:!0});var h=f(m());e.watch((function(){return b.value.indentWithTab}),(function(e){return h(i.view,e)}),{immediate:!0});var w=s();e.watch((function(){return b.value.tabSize}),(function(e){return w(i.view,p(e))}),{immediate:!0});var y=s();e.watch((function(){return b.value.placeholder}),(function(e){return y(i.view,d(e))}),{immediate:!0});var O=s();e.watch((function(){return b.value.style}),(function(e){return O(i.view,v(e))}),{immediate:!0}),e.watch((function(){return t.modelValue}),(function(e){e!==function(e){return e.state.doc.toString()}(i.view)&&function(e,t){e.dispatch({changes:{from:0,to:e.state.doc.length,insert:t}})}(i.view,e)})),b.value.autofocus&&function(e){e.focus()}(i.view),r.emit("ready",Object.assign(Object.assign({},i),{container:o.value}))})),e.onBeforeUnmount((function(){!function(e){e.destroy()}(i.view)})),function(){return e.h("div",{class:"v-codemirror",style:{display:"contents"},ref:o})}}}),w=h,y=function(e,t){e.component(h.name,h),function(e,t){e.provide(u,t)}(e,t)},O={Codemirror:h,install:y};exports.Codemirror=w,exports.DEFAULT_CONFIG=g,exports.default=O,exports.install=y;//# sourceMappingURL=vue-codemirror.cjs.js.map
